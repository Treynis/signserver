<project name="ooxmlsigner" default="ooxmlsignermar" basedir="..">



	<target name="ooxmlsignermar" unless="buildMailSigner">
		<path id="ooxmlsigner.build.classpath">
			<path refid="signserver.compile.classpath" />
			<path location="${build}" />
		</path>

		<taskdef name="mar" classname="org.signserver.anttasks.MarAntTask" classpathref="ooxmlsigner.build.classpath" />

		<taskdef name="part" classname="org.signserver.anttasks.PartAntTask" classpathref="ooxmlsigner.build.classpath" />

		<javac destdir="${build}" debug="on" includeantruntime="no" encoding="iso8859-1" target="${server.java.target}" source="${server.java.target}">
			<classpath refid="ooxmlsigner.build.classpath" />
			<src path="${src.java}" />
			<include name="org/signserver/module/ooxmlsigner/*.java" />
			<include name="org/openxml4j/opc/*.java" />
		</javac>

		<jar jarfile="dist-server/ooxmlsigner-module.jar">
			<fileset dir="${build}">
				<include name="org/signserver/module/ooxmlsigner/**" />
				<include name="org/openxml4j/opc/**" />
			</fileset>
		</jar>
		<mar version="${mar.versions}" modulename="ooxmlsigner" verbose="true" destfile="${basedir}/dist-server/ooxmlsigner.mar">
			<part>
				<fileset dir="lib/ext">
					<include name="xercesImpl-2_9_1" />
				</fileset>
				<fileset dir="lib/module/ooxmlsigner">
					
					<include name="jaxen-1.1.jar" />
					<include name="openxml4j-bin-beta.jar" />
				</fileset>
				<fileset dir="lib/endorsed">
					<include name="xmlsec-1.4.3.jar" />
					<include name="pull-parser-2.1.10.jar" />
					<include name="xsdlib-20030807.jar" />
				</fileset>
				<fileset dir="dist-server">
					<include name="ooxmlsigner-module.jar" />
				</fileset>
				<fileset dir="src/module-configs/ooxmlsigner">
					<include name="*.properties" />
				</fileset>
			</part>
		</mar>
	</target>

</project>
